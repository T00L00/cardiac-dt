## Terminology

anisotropic tissue
- tissue whose mechanical properties change depending on the direction in which they are measured.

# Current approaches for digital twinning

The following are some papers I found highlighting the latest techniques for simulating the heart of various parts of the heart.

## Full physics simulation of the heart

[GPU accelerated DT of the human heart](https://www.nature.com/articles/s41598-023-34098-8)

### Methodology

1. Construct 3D meshes from medical images

2. Fluid simulation
  - Navier-stokes eq for incompressible fluid
  - Apply immersed boundary method
    - No slip conditions on wet surfaces of heart by transferring forces between the Eulerian fluid grid and the Lagrangian structural grid
  - Carreau-Yasuda model used for non-newtonian blood to capture shear-thinning behavior

3. Structural simulation
  - Spring-network model for simulating elasticity and dynamics of heart tissue
  - 3D tetrahedral mesh for mycardium (ventricles + atria)
  - 2D triangular mesh used for valve leaflets
  - Fung-type constitutive relation modeled by Fung-type constitutive relation
    - From strain energy density, get the forces and displacements?

4. Electrophysiology simulation
  - Bidomain equation
  - Courtemanche model for atrial myocytes
  - Stewart model for purkinje network
  - Ten Tusscher-Panfilov model for ventricular myocytes

5. Fluid-Structure-Electrophysiology Interaction (FSEI) framework
  - integrates all the above simulations
  - Fluid-structure coupling
    - forces from fluid dynamics applied to the structural solver
    - resulting deformations of heart tissues fed back to fluid solver

  - Electrophysiology-structure coupling
    - active tension generated by ep model influences structural dynamics

  - Strong + loose coupling
    - strong coupling = iterate between solvers until convergence
    - loose coupling = use a small time step to ensure stability

Boundary conditions
- Windkessel models used at inlets and outlets of torso-box

### Computation cost
- ~1e9 degrees of freedom
- 11.3 h to simulate a single heart beat
- 8 TB of output data to process
- 8 A100 GPUs

## Deep learning surrogate for FEA of aortic wall stresses

[DL surrogate for FEA](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5805990/pdf/rsif20170844.pdf)

- Divide aorta into 25 regions
- PCA to encoded the aorta shape 
- NN: 2 hidden layers (128 nodes each), converting shape to stress
- Each region runs an MLP to compute the stresses in that region

## MeshGraphNets

[MeshGraphNet](https://arxiv.org/pdf/2303.07310)  

[Original implementations](https://github.com/google-deepmind/deepmind-research/tree/master/meshgraphnets)

Original MGN are data-driven and require a training dataset of pure physics simulations.

Encoder
1. Encodes physical mesh into multigraph where mesh nodes become graph nodes and mesh edges become bidirectional graph edges.
    - Lagrangian systems have "world" edges added to the the graph. These world edges enable the network to learn external dynamics such as collisions and contact.
2. Encode features into graph nodes and edges

Processor
- Don't fully understand this part yet. Need to spend more time.

Decoder + State Updater
- Uses an MLP to transform latent node features into one or more output features
- Output features are basically higher-order derivatives of the dynamic quantity of interest
- Integrate output features with forward-Euler integration to get dynamic quantity at time, t + 1

[Physics-informed MGNs](https://www.sciencedirect.com/science/article/pii/S004578252400358X)

Use FEM equations has loss functions

[ROMs for cardiovascular simulations with GNNs](https://www.sciencedirect.com/science/article/abs/pii/S0010482523011411)


PINNs usually fail to adapt to different geometries. MeshGraphNets to derive 1-D surrogate ROM for blood flow through the heart.

## Different approaches we can take

Things we need to decide:

1. What prediction do we want to do?
  - -omics-based predictions 
    - This falls in the realm of NLP and LLMs, not physics

  - physics-based predictions

2. For physics-based digital twinning:

- Full physics simulation of a process
  - computationally costly
  - pick a very simple system

- Peform ROM on problem to simulate a smaller representation of the process

- Full physics simulation of a process to generate training data, train ML model to predict the desired quantity
  - computationally costly but results in ML model capable of quickly predicting the desired quantity under different conditions


Random useful repo of cardiovascular models:
[Vascular model repo](https://www.vascularmodel.com/)
